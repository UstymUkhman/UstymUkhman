<!doctype html>
<html lang="en-us">
  <head>
    <title>webDOOM</title>

    <meta charset="utf-8">
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <style type="text/css">
      html {
        -webkit-tap-highlight-color: transparent;
        -webkit-overflow-scrolling: none;
        background-color: transparent;
        font-variant-ligatures: none;
        -webkit-touch-callout: none;
        text-size-adjust: none;

        pointer-events: none;
        user-select: none;
        overflow: hidden;

        max-height: 100%;
        min-height: 100%;

        max-width: 100%;
        min-width: 100%;

        height: 100%;
        width: 100%;

        padding: 0;
        margin: 0;
      }

      canvas {
        pointer-events: all;
        position: absolute;
        margin: auto;

        width: 133.33vh;
        height: 100vh;

        bottom: 0;
        right: 0;
        left: 0;
        top: 0;
      }
    </style>
  </head>

  <body>
    <canvas id="canvas"></canvas>

    <script type="text/javascript">
      document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock
      document.exitFullscreen = document.exitFullscreen || document.mozCancelFullScreen || document.webkitCancelFullScreen

      var onPointerLockChange = function () { Module.inFullscreen = !Module.inFullscreen; };

      document.addEventListener('mozpointerlockchange', onPointerLockChange, false)
      document.addEventListener('pointerlockchange', onPointerLockChange, false)

      var Module = {
        dependencies: 0,
        inFullscreen: false,

        canvas: (function () {
          var canvas = document.getElementById('canvas');

          canvas.addEventListener('webglcontextlost', function (event) {
            alert('WebGL context lost. You need to reload the page.');
            event.preventDefault();
          }, false);

          canvas.addEventListener('contextmenu', function (event) {
            event.preventDefault();
          });

          canvas.addEventListener('dblclick', function (event) {
            if (!Module.inFullscreen) {
              Module.requestFullscreen(true, false);
            } else {
              document.exitPointerLock();
              document.exitFullscreen();
            }
          });

          return canvas;
        })(),

        monitorRunDependencies: function (toLoad) {
          if (toLoad < this.dependencies) {
            this.updateProgress(this.dependencies - toLoad);
          } else {
            this.dependencies = toLoad;
          }
        },

        updateProgress: function (progress) {
          window.parent.doomLoadingProgress = progress / this.dependencies * 100;
        }
      };
    </script>

    <script async type="text/javascript" src="web-doom.js"></script>
  </body>
</html>
